{% extends "remapp/base.html" %}

      {% block toprow %}
      <h1><img src="{{ STATIC_URL }}img/openrem0055.png" height="55" width="55" class="openrem-logo">OpenREM database browser and export</h1>

      <p>
          There are {{ homedata.total }} studies in this database. Page last refreshed on {% now "jS F Y \a\t H:i" %}.
      </p>
      {% endblock %}


      {% block mainblock %}
{% load humanize %}

<table class="table table-bordered">
    <tr>
        {% if request.user.userprofile.displayCT %}<th><a href="/openrem/ct/">CT</a></th>{% endif %}{% if request.user.userprofile.displayRF %}<th><a href="/openrem/rf/">Fluoroscopy</a></th>{% endif %}{% if request.user.userprofile.displayMG %}<th><a href="/openrem/mg/">Mammography</a></th>{% endif %}{% if request.user.userprofile.displayDX %}<th><a href="/openrem/dx/">Radiography</a></th>{% endif %}
    </tr>
    <tr>
        {% if request.user.userprofile.displayCT %}<td>{{ homedata.ct }}</td>{% endif %}{% if request.user.userprofile.displayRF %}<td>{{ homedata.rf }}</td>{% endif %}{% if request.user.userprofile.displayMG %}<td>{{ homedata.mg }}</td>{% endif %}{% if request.user.userprofile.displayDX %}<td>{{ homedata.dx }}</td>{% endif %}
    </tr>
</table>

{% if request.user.userprofile.displayCT %}
<h4>CT summary table</h4>
<table class="table table-bordered table-hover row-clickable">
    <tr>
        <th>Station name</th><th>Number of studies</th><th>Latest study</th>
    </tr>
    {% for key,value in homedata.CT.items %}
        <tr>
            <td>
                <a href="/openrem/ct/?station_name={{ key }}&o=-study_date">
                    {{ value.institution }} ({{ key }})
                </a>
            </td>
            <td>
                <a href="/openrem/ct/?station_name={{ key }}&o=-study_date">
                {{ value.total }}
                </a>
            </td>
            <td>
                <a href="/openrem/ct/?station_name={{ key }}&o=-study_date">
                {{ value.latest|naturaltime }}
                </a>
            </td>
        </tr>
    {% endfor %}
</table>
{% endif %}

{% if request.user.userprofile.displayRF %}
<h4>Fluoroscopy summary table</h4>
<table class="table table-bordered table-hover row-clickable">
    <tr>
        <th>Station name</th><th>Number of studies</th><th>Latest study</th>
    </tr>
    {% for key,value in homedata.RF.items %}
        <tr>
            <td>
                <a href="/openrem/rf/?station_name={{ key }}&o=-study_date">
                    {{ value.institution }} ({{ key }})
                </a>
            </td>
            <td>
                <a href="/openrem/rf/?station_name={{ key }}&o=-study_date">
                    {{ value.total }}
                </a>
            </td>
            <td>
                <a href="/openrem/rf/?station_name={{ key }}&o=-study_date">
                    {{ value.latest|naturaltime }}
                </a>
            </td>
        </tr>
    {% endfor %}
</table>
{% endif %}

{% if request.user.userprofile.displayMG %}
<h4>Mammography summary table</h4>
<table class="table table-bordered table-hover row-clickable">
    <tr>
        <th>Station name</th><th>Number of studies</th><th>Latest study</th>
    </tr>
    {% for key,value in homedata.MG.items %}
        <tr>
            <td>
                <a href="/openrem/mg/?station_name={{ key }}&o=-study_date">
                    {{ value.institution }} ({{ key }})
                </a>
            </td>
            <td>
                <a href="/openrem/mg/?station_name={{ key }}&o=-study_date">
                    {{ value.total }}
                </a>
            </td>
            <td>
                <a href="/openrem/mg/?station_name={{ key }}&o=-study_date">
                    {{ value.latest|naturaltime }}
                </a>
            </td>
        </tr>
    {% endfor %}
</table>
{% endif %}

{% if request.user.userprofile.displayDX %}
<h4>Radiography summary table</h4>
<table class="table table-bordered table-hover row-clickable">
    <tr>
        <th>Station name</th><th>Number of studies</th><th>Latest study</th>
    </tr>
    {% for key,value in homedata.DX.items %}
        <tr>
            <td>
                <a href="/openrem/dx/?station_name={{ key }}&o=-study_date">
                    {{ value.institution }} ({{ key }})
                </a>
            </td>
            <td>
                <a href="/openrem/dx/?station_name={{ key }}&o=-study_date">
                    {{ value.total }}
                </a>
            </td>
            <td>
                <a href="/openrem/dx/?station_name={{ key }}&o=-study_date">
                    {{ value.latest|naturaltime }}
                </a>
            </td>
        </tr>
    {% endfor %}
</table>
{% endif %}

{% endblock %}	
